<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>Sphere - Expense Categories</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/css/app.css" rel="stylesheet" />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <style>
      body {
        font-family: "Poppins", sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <nav id="sidebar" class="sidebar js-sidebar">
        <div class="sidebar-content js-simplebar">
          <a class="sidebar-brand mb-3" href="userDashboard.html">
            <i class="bi bi-globe align-middle"></i>
            <span class="align-middle ms-1">Sphere</span>
          </a>

          <ul class="sidebar-nav">
            <li class="sidebar-item">
              <a class="sidebar-link" href="userDashboard.html">
                <i class="bi bi-speedometer2 align-middle"></i>
                <span class="align-middle">Dashboard</span>
              </a>
            </li>

            <li class="sidebar-item active">
              <a
                data-bs-target="#expenses"
                data-bs-toggle="collapse"
                class="sidebar-link collapsed"
                aria-expanded="false"
              >
                <i class="bi bi-wallet2 align-middle"></i>
                <span class="align-middle">Expenses</span>
              </a>
              <ul
                id="expenses"
                class="sidebar-dropdown list-unstyled collapse"
                data-bs-parent="#sidebar"
              >
                <li class="sidebar-item">
                  <a class="sidebar-link" href="expenses.html"
                    >Manage Expenses</a
                  >
                </li>
                <li class="sidebar-item active">
                  <a class="sidebar-link" href="expenseCategories.html"
                    >Expense Categories</a
                  >
                </li>
                <li class="sidebar-item">
                  <a class="sidebar-link" href="expenseLabels.html"
                    >Expense Labels</a
                  >
                </li>
                <li class="sidebar-item">
                  <a class="sidebar-link" href="expenseSummary.html"
                    >Expense Summary</a
                  >
                </li>
              </ul>
            </li>

            <li class="sidebar-item">
              <a
                data-bs-target="#invoices"
                data-bs-toggle="collapse"
                class="sidebar-link collapsed"
                aria-expanded="false"
              >
                <i class="bi bi-file-earmark-text align-middle"></i>
                <span class="align-middle">Invoices</span>
              </a>
              <ul
                id="invoices"
                class="sidebar-dropdown list-unstyled collapse"
                data-bs-parent="#sidebar"
              >
                <li class="sidebar-item">
                  <a class="sidebar-link" href="invoices.html"
                    >Manage Invoices</a
                  >
                </li>
                <li class="sidebar-item">
                  <a class="sidebar-link" href="invoiceAccounts.html"
                    >Invoice Accounts</a
                  >
                </li>
                <li class="sidebar-item">
                  <a class="sidebar-link" href="invoiceSummary.html"
                    >Invoice Summary</a
                  >
                </li>
              </ul>
            </li>

            <li class="sidebar-item">
              <a class="sidebar-link" href="tasks.html">
                <i class="bi bi-list-task align-middle"></i>
                <span class="align-middle">Tasks</span>
              </a>
            </li>

            <li class="sidebar-item">
              <a class="sidebar-link" href="clients.html">
                <i class="bi bi-people align-middle"></i>
                <span class="align-middle">Clients</span>
              </a>
            </li>

            <li class="sidebar-item">
              <a class="sidebar-link" href="staff.html">
                <i class="bi bi-person-badge align-middle"></i>
                <span class="align-middle">Staff</span>
              </a>
            </li>

            <li class="sidebar-item">
              <a class="sidebar-link" href="userProfile.html">
                <i class="align-middle" data-feather="user"></i>
                <span class="align-middle">Profile</span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <div class="main">
        <nav class="navbar navbar-expand navbar-light navbar-bg">
          <a class="sidebar-toggle js-sidebar-toggle">
            <i class="hamburger align-self-center"></i>
          </a>

          <div class="navbar-collapse collapse">
            <ul class="navbar-nav navbar-align">
              <li class="nav-item dropdown">
                <a
                  class="nav-icon dropdown-toggle"
                  href="#"
                  id="alertsDropdown"
                  data-bs-toggle="dropdown"
                >
                  <div class="position-relative">
                    <i class="align-middle" data-feather="bell"></i>
                    <span class="indicator">4</span>
                  </div>
                </a>
                <div
                  class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0"
                  aria-labelledby="alertsDropdown"
                >
                  <div class="dropdown-menu-header">4 New Notifications</div>
                  <div class="list-group">
                    <a href="#" class="list-group-item">
                      <div class="row g-0 align-items-center">
                        <div class="col-2">
                          <i
                            class="text-danger"
                            data-feather="alert-circle"
                          ></i>
                        </div>
                        <div class="col-10">
                          <div class="text-dark">Update completed</div>
                          <div class="text-muted small mt-1">
                            Restart server 12 to complete the update.
                          </div>
                          <div class="text-muted small mt-1">30m ago</div>
                        </div>
                      </div>
                    </a>
                    <a href="#" class="list-group-item">
                      <div class="row g-0 align-items-center">
                        <div class="col-2">
                          <i class="text-warning" data-feather="bell"></i>
                        </div>
                        <div class="col-10">
                          <div class="text-dark">Lorem ipsum</div>
                          <div class="text-muted small mt-1">
                            Aliquam ex eros, imperdiet vulputate hendrerit et.
                          </div>
                          <div class="text-muted small mt-1">2h ago</div>
                        </div>
                      </div>
                    </a>
                    <a href="#" class="list-group-item">
                      <div class="row g-0 align-items-center">
                        <div class="col-2">
                          <i class="text-primary" data-feather="home"></i>
                        </div>
                        <div class="col-10">
                          <div class="text-dark">Login from 192.186.1.8</div>
                          <div class="text-muted small mt-1">5h ago</div>
                        </div>
                      </div>
                    </a>
                    <a href="#" class="list-group-item">
                      <div class="row g-0 align-items-center">
                        <div class="col-2">
                          <i class="text-success" data-feather="user-plus"></i>
                        </div>
                        <div class="col-10">
                          <div class="text-dark">New connection</div>
                          <div class="text-muted small mt-1">
                            Christina accepted your request.
                          </div>
                          <div class="text-muted small mt-1">14h ago</div>
                        </div>
                      </div>
                    </a>
                  </div>
                  <div class="dropdown-menu-footer">
                    <a href="notifications.html" class="text-muted"
                      >Show all notifications</a
                    >
                  </div>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-icon dropdown-toggle d-inline-block d-sm-none"
                  href="#"
                  data-bs-toggle="dropdown"
                >
                  <i class="align-middle" data-feather="settings"></i>
                </a>

                <a
                  class="nav-link dropdown-toggle d-none d-sm-inline-block"
                  href="#"
                  data-bs-toggle="dropdown"
                >
                  <i class="align-middle" data-feather="user"></i>
                  <span class="text-dark align-middle">John Doe</span>
                </a>
                <div class="dropdown-menu dropdown-menu-end">
                  <a class="dropdown-item" href="userProfile.html"
                    ><i class="align-middle me-1" data-feather="user"></i>
                    Profile</a
                  >
                  <a class="dropdown-item" href="signIn.html"
                    ><i class="align-middle me-1" data-feather="log-out"></i>
                    Log out</a
                  >
                </div>
              </li>
            </ul>
          </div>
        </nav>

        <main class="content" x-data="expenseCategoryManager()">
          <div class="container-fluid p-0">
            <h1 class="mb-4 text-secondary">Expense Categories</h1>

            <button
              class="btn btn-primary mb-3"
              @click="showAddCategoryModal = true"
            >
              Add Category
            </button>

            <div class="card">
              <div class="card-header">
                <div
                  class="d-flex flex-md-row justify-content-between align-items-center gap-2"
                >
                  <h5 class="card-title">Expense Categories</h5>
                </div>
              </div>

              <div class="card-body">
                <div>
                  <div class="table-responsive">
                    <table class="table table-striped table-hover">
                      <thead>
                        <tr>
                          <th colspan="2">
                            <div
                              class="d-flex justify-content-between align-items-center"
                              style="position: relative"
                            >
                              <span
                                class="cursor-pointer"
                                @click="sort('name')"
                              >
                                Name
                                <span
                                  x-show="sortKey === 'name'"
                                  x-text="sortOrder === 'asc' ? '▲' : '▼'"
                                  class="small"
                                ></span>
                              </span>
                              <span style="position: absolute; left: 85%"
                                >Actions</span
                              >
                            </div>
                          </th>
                        </tr>
                      </thead>

                      <tbody>
                        <template
                          x-for="(category, index) in paginatedCategories()"
                          :key="category.id"
                        >
                          <tr>
                            <td colspan="2">
                              <div
                                class="d-flex justify-content-between align-items-center"
                                style="position: relative"
                              >
                                <span
                                  x-text="category.name"
                                  class="text-nowrap overflow-hidden text-truncate"
                                ></span>
                                <span
                                  class="d-flex gap-2"
                                  style="position: absolute; left: 85%"
                                >
                                  <button
                                    class="btn btn-warning btn-sm text-dark"
                                    @click="showEditCategoryModal = true; selectedCategory = category"
                                  >
                                    <i class="bi bi-pencil-square"></i>
                                  </button>
                                  <button
                                    class="btn btn-danger btn-sm"
                                    @click="showDeleteCategoryModal = true; selectedCategory = category"
                                  >
                                    <i class="bi bi-trash"></i>
                                  </button>
                                  <button
                                    class="btn btn-link btn-sm"
                                    @click="toggleAssociatedExpenses; selectedCategory = category"
                                  >
                                    <i
                                      class="bi"
                                      :class="category.expanded ? 'bi-chevron-up' : 'bi-chevron-down'"
                                    ></i>
                                  </button>
                                </span>
                              </div>

                              <!-- Accordion Content: Associated Expenses List -->
                              <div
                                x-show="category.expanded"
                                x-transition
                                class="mt-2"
                              >
                                <ul class="list-group">
                                  <template
                                    x-for="expense in getAssociatedExpenses(category.name)"
                                    :key="expense.id"
                                  >
                                    <li
                                      class="list-group-item d-flex justify-content-between"
                                      style="position: relative"
                                    >
                                      <span
                                        x-text="expense.description"
                                        class="text-nowrap overflow-hidden text-truncate"
                                        style="max-width: 150px"
                                      ></span>
                                      <button
                                        class="btn btn-sm btn-info"
                                        style="position: absolute; left: 85%"
                                        @click="showViewExpenseModal = true; selectedExpense = expense"
                                      >
                                        <i class="bi bi-eye"></i>
                                      </button>
                                    </li>
                                  </template>
                                  <li
                                    class="list-group-item text-muted"
                                    x-show="getAssociatedExpenses(category.name).length === 0"
                                  >
                                    No expenses associated.
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                        </template>
                      </tbody>
                    </table>
                  </div>

                  <div
                    class="d-flex flex-column flex-md-row justify-content-between mt-4"
                  >
                    <p x-show="categories.length &lt; 1">No entries found</p>
                    <p x-show="categories.length > 0">
                      Showing
                      <span x-text="firstItem"></span>
                      - <span x-text="lastItem"></span> of
                      <span x-text="categories.length"></span> entries
                    </p>
                    <nav
                      aria-label="Page navigation"
                      x-show="categories.length > 10"
                    >
                      <ul
                        class="pagination pagination-sm justify-content-center"
                      >
                        <li class="page-item">
                          <button
                            @click="goToPage(currentPage - 1)"
                            :disabled="currentPage === 1"
                            class="page-link"
                          >
                            <span aria-hidden="true">&laquo;</span>
                          </button>
                        </li>

                        <template x-for="page in totalPages" :key="page">
                          <li
                            class="page-item"
                            :class="{'active': currentPage === page}"
                          >
                            <button
                              @click="goToPage(page)"
                              class="page-link"
                              x-text="page"
                            ></button>
                          </li>
                        </template>

                        <li class="page-item">
                          <button
                            @click="goToPage(currentPage + 1)"
                            :disabled="currentPage === totalPages"
                            class="page-link"
                          >
                            <span aria-hidden="true">&raquo;</span>
                          </button>
                        </li>
                      </ul>
                    </nav>
                  </div>
                </div>
              </div>
            </div>

            <!-- Add Category Modal -->
            <div
              class="modal fade"
              :class="{ 'show d-block': showAddCategoryModal}"
              tabindex="-1"
              aria-labelledby="addCategoryModalLabel"
              aria-hidden="true"
              style="background-color: rgba(0, 0, 0, 0.5)"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="addCategoryModalLabel">
                      Add Category
                    </h5>
                  </div>
                  <div class="modal-body">
                    <form @submit.prevent="addCategories($event)">
                      <div id="categoryContainer">
                        <div class="mb-3">
                          <label for="categoryName" class="form-label"
                            >Category Name</label
                          >
                          <input
                            type="text"
                            class="form-control"
                            name="category-name"
                            required
                          />
                        </div>
                      </div>
                      <button class="btn btn-primary" @click="addCategoryField">
                        Add More
                      </button>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="reset"
                      class="btn btn-secondary"
                      @click="showAddCategoryModal = false"
                    >
                      Cancel
                    </button>
                    <button type="submit" class="btn btn-success">
                      Submit
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Edit Category Modal -->
            <div
              class="modal fade"
              :class="{ 'show d-block': showEditCategoryModal}"
              tabindex="-1"
              aria-labelledby="editCategoryModalLabel"
              aria-hidden="true"
              style="background-color: rgba(0, 0, 0, 0.5)"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="editCategoryModalLabel">
                      Edit Category
                    </h5>
                  </div>
                  <div class="modal-body">
                    <form @submit.prevent="updateCategory($event)">
                      <div class="mb-3">
                        <label for="editCategoryName" class="form-label"
                          >Category Name</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="editCategoryName"
                          x-model="selectedCategory.name"
                          required
                        />
                      </div>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="reset"
                      class="btn btn-secondary"
                      @click="showEditCategoryModal = false; selectedCategory = null"
                    >
                      Cancel
                    </button>
                    <button type="submit" class="btn btn-success">
                      Save Changes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Delete Category Modal -->
            <div
              class="modal fade"
              :class="{ 'show d-block': showDeleteCategoryModal}"
              tabindex="-1"
              aria-labelledby="deleteCategoryModalLabel"
              aria-hidden="true"
              style="background-color: rgba(0, 0, 0, 0.5)"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="deleteCategoryModalLabel">
                      Delete Category
                    </h5>
                  </div>
                  <div class="modal-body">
                    Are you sure you want to delete the category "<span
                      x-text="selectedCategory.name"
                    ></span
                    >"?
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                      @click="showDeleteCategoryModal = false; selectedCategory = null"
                    >
                      Cancel
                    </button>
                    <button
                      type="button"
                      class="btn btn-danger"
                      @click="deleteCategory"
                    >
                      Delete
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- View Expense Modal -->
            <div
              class="modal fade"
              :class="{ 'show d-block': showViewExpenseModal}"
              tabindex="-1"
              aria-labelledby="viewExpenseModalLabel"
              aria-hidden="true"
              style="background-color: rgba(0, 0, 0, 0.5)"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="viewExpenseModalLabel">
                      Expense Details
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                      @click="showViewExpenseModal = false; selectedExpense = null"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <p>
                      <strong>Date:</strong>
                      <span x-text="selectedExpense.date"></span>
                    </p>
                    <p>
                      <strong>Description:</strong>
                      <span x-text="selectedExpense.description"></span>
                    </p>
                    <p>
                      <strong>Amount:</strong>
                      <span x-text="`$${selectedExpense.amount}`"></span>
                    </p>
                    <p>
                      <strong>Category:</strong>
                      <span x-text="selectedExpense.category"></span>
                    </p>
                    <p>
                      <strong>Label:</strong>
                      <span x-text="selectedExpense.label"></span>
                    </p>

                    <div
                      x-show="selectedExpense.attachments && selectedExpense.attachments.length > 0"
                    >
                      <p><strong>Attachments:</strong></p>
                      <ul>
                        <template
                          x-for="file in selectedExpense.attachments"
                          :key="file.name"
                        >
                          <li>
                            <a
                              :href="file.url"
                              target="_blank"
                              x-text="file.name"
                            ></a>
                          </li>
                        </template>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script src="assets/js/app.js"></script>

    <script>
      function expenseCategoryManager() {
        return {
          expenses: [
            {
              id: 1,
              amount: 250.75,
              date: "2024-11-10",
              description: "Flight to New York for client meeting",
              category: "Travel",
              label: "Urgent",
              attachments: [
                {
                  name: "flight_receipt.pdf",
                  url: "path/to/flight_receipt.pdf",
                },
                { name: "itinerary.png", url: "path/to/itinerary.png" },
              ],
            },
            {
              id: 2,
              amount: 45.99,
              date: "2024-11-12",
              description: "Lunch with team at Italian restaurant",
              category: "Food & Dining",
              label: "Business",
              attachments: [
                { name: "lunch_receipt.jpg", url: "path/to/lunch_receipt.jpg" },
              ],
            },
            {
              id: 3,
              amount: 120.0,
              date: "2024-11-14",
              description: "Office supplies: pens, notebooks, and printer ink",
              category: "Office Supplies",
              label: "Reimbursable",
              attachments: [
                {
                  name: "supplies_invoice.pdf",
                  url: "path/to/supplies_invoice.pdf",
                },
              ],
            },
            {
              id: 4,
              amount: 89.5,
              date: "2024-11-15",
              description: "Utility bill for office",
              category: "Utilities",
              label: "Non-reimbursable",
              attachments: [
                { name: "utility_bill.pdf", url: "path/to/utility_bill.pdf" },
              ],
            },
            {
              id: 5,
              amount: 300.0,
              date: "2024-11-16",
              description: "Tickets to company-sponsored event",
              category: "Entertainment",
              label: "Business",
              attachments: [
                { name: "event_tickets.pdf", url: "path/to/event_tickets.pdf" },
              ],
            },
            {
              id: 6,
              amount: 75.2,
              date: "2024-11-17",
              description: "Taxi fare to client office",
              category: "Travel",
              label: "Reimbursable",
              attachments: [
                { name: "taxi_receipt.png", url: "path/to/taxi_receipt.png" },
              ],
            },
            {
              id: 7,
              amount: 60.0,
              date: "2024-11-18",
              description: "Catering service for office lunch",
              category: "Food & Dining",
              label: "Business",
              attachments: [
                {
                  name: "catering_receipt.jpg",
                  url: "path/to/catering_receipt.jpg",
                },
              ],
            },
            {
              id: 8,
              amount: 500.0,
              date: "2024-11-19",
              description: "Hotel stay for conference",
              category: "Travel",
              label: "Urgent",
              attachments: [
                { name: "hotel_invoice.pdf", url: "path/to/hotel_invoice.pdf" },
              ],
            },
            {
              id: 9,
              amount: 32.5,
              date: "2024-11-20",
              description: "Stationery purchase",
              category: "Office Supplies",
              label: "Non-reimbursable",
              attachments: [
                {
                  name: "stationery_receipt.pdf",
                  url: "path/to/stationery_receipt.pdf",
                },
              ],
            },
            {
              id: 10,
              amount: 120.0,
              date: "2024-11-21",
              description: "Monthly internet subscription",
              category: "Utilities",
              label: "Business",
              attachments: [
                { name: "internet_bill.pdf", url: "path/to/internet_bill.pdf" },
              ],
            },
            {
              id: 11,
              amount: 75.0,
              date: "2024-11-22",
              description: "Dinner with client",
              category: "Food & Dining",
              label: "Reimbursable",
              attachments: [
                {
                  name: "dinner_receipt.png",
                  url: "path/to/dinner_receipt.png",
                },
              ],
            },
            {
              id: 12,
              amount: 150.0,
              date: "2024-11-23",
              description: "New office chair",
              category: "Office Supplies",
              label: "Non-reimbursable",
              attachments: [
                { name: "chair_invoice.pdf", url: "path/to/chair_invoice.pdf" },
              ],
            },
            {
              id: 13,
              amount: 50.0,
              date: "2024-11-24",
              description: "Water bill",
              category: "Utilities",
              label: "Non-reimbursable",
              attachments: [
                { name: "water_bill.pdf", url: "path/to/water_bill.pdf" },
              ],
            },
            {
              id: 14,
              amount: 220.0,
              date: "2024-11-25",
              description: "Team-building activity expenses",
              category: "Entertainment",
              label: "Business",
              attachments: [
                {
                  name: "team_building_expenses.pdf",
                  url: "path/to/team_building_expenses.pdf",
                },
              ],
            },
            {
              id: 15,
              amount: 90.0,
              date: "2024-11-26",
              description: "Taxi fare to airport",
              category: "Travel",
              label: "Urgent",
              attachments: [
                {
                  name: "airport_taxi_receipt.jpg",
                  url: "path/to/airport_taxi_receipt.jpg",
                },
              ],
            },
          ],
          categories: [
            {
              id: 1,
              name: "Travel",
              expanded: false,
            },
            {
              id: 2,
              name: "Food & Dining",
              expanded: false,
            },
            {
              id: 3,
              name: "Office Supplies",
              expanded: false,
            },
            {
              id: 4,
              name: "Utilities",
              expanded: false,
            },
            {
              id: 5,
              name: "Entertainment",
              expanded: false,
            },
          ],

          sortKey: "name",
          sortOrder: "asc",
          currentPage: 1,
          itemsPerPage: 10,
          selectedCategory: null,
          selectedExpense: null,
          showAddCategoryModal: false,
          showEditCategoryModal: false,
          showDeleteCategoryModal: false,
          showViewExpenseModal: false,

          toggleAssociatedExpenses() {
            this.paginatedCategories().forEach((category) => {
              category.expanded =
                category.id === this.selectedCategory.id
                  ? !category.expanded
                  : false;
            });
          },

          // Returns expenses for the given category name
          getAssociatedExpenses(categoryName) {
            return this.expenses.filter(
              (expense) =>
                expense.category.toLowerCase() === categoryName.toLowerCase()
            );
          },

          addCategoryField() {
            const categoryContainer =
              document.getElementById("categoryContainer");
            const nameField = `
            <div class="mb-3">
              <label for="categoryName" class="form-label">Category Name</label>
              <input type="text" class="form-control" name="category-name" required>
            </div>
        `;
            categoryContainer.insertAdjacentHTML("beforeend", nameField);
          },

          addCategories(event) {
            const categoryNames = document.querySelectorAll(
              'input[name="category-name"]'
            );

            categoryNames.forEach((name) => {
              this.categories.push({
                name: name.value,
                id: this.categories.length + 1,
              });
            });

            event.target.reset();
            this.showAddCategoryModal = false;
          },

          updateCategory(event) {
            const index = this.categories.findIndex(
              (c) => c.id === this.selectedCategory.id
            );
            if (index !== -1) {
              this.categories[index].name = this.selectedCategory.name;
            }

            event.target.reset();
            this.selectedCategory = null;
            this.showEditCategoryModal = false;
          },

          deleteCategory() {
            if (this.selectedCategory.associatedExpenses === 0) {
              this.categories = this.categories.filter(
                (category) => category.id !== this.selectedCategory.id
              );
              this.selectedCategory = null;
              this.showDeleteCategoryModal = false;
            } else {
              alert("Cannot delete category with associated expenses.");
            }
          },

          sort(column) {
            if (this.sortKey === column) {
              this.sortOrder = this.sortOrder === "asc" ? "desc" : "asc";
            } else {
              this.sortKey = column;
              this.sortOrder = "asc";
            }
          },

          sortedCategories() {
            return this.categories.slice().sort((a, b) => {
              let modifier = this.sortOrder === "asc" ? 1 : -1;
              if (this.sortKey === "name") {
                return a.name > b.name ? 1 * modifier : -1 * modifier;
              }
            });
          },

          paginatedCategories() {
            const start = (this.currentPage - 1) * this.itemsPerPage;
            const end = this.currentPage * this.itemsPerPage;
            return this.sortedCategories().slice(start, end);
          },

          get totalPages() {
            return Math.ceil(this.categories.length / this.itemsPerPage);
          },

          goToPage(page) {
            if (page > 0 && page <= this.totalPages) {
              this.currentPage = page;
            }
          },

          get firstItem() {
            return (this.currentPage - 1) * this.itemsPerPage + 1;
          },

          get lastItem() {
            const end = this.currentPage * this.itemsPerPage;
            return end > this.categories.length ? this.categories.length : end;
          },
        };
      }
    </script>
  </body>
</html>
